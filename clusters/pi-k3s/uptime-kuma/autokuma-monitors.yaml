apiVersion: v1
kind: ConfigMap
metadata:
  name: autokuma-monitors
  namespace: uptime-kuma
data:
  # Discord notification - uses AutoKuma notification format
  # Uses __notification_ prefix for AutoKuma notification management
  __notification_discord.json: |
    {
      "type": "notification",
      "name": "Discord Alerts",
      "active": true,
      "isDefault": true,
      "applyExisting": true,
      "config": {
        "type": "discord",
        "discordWebhookUrl": "${DISCORD_WEBHOOK_URL}",
        "discordUsername": "Uptime Kuma"
      }
    }
  # Each file is a separate monitor - filename (without .json) becomes the monitor ID
  pihole-dns.json: |
    {
      "type": "port",
      "name": "Pi-hole DNS",
      "hostname": "192.168.1.55",
      "port": 53,
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  pihole-admin.json: |
    {
      "type": "http",
      "name": "Pi-hole Admin",
      "url": "https://pihole.lab.mtgibbs.dev/admin/",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  grafana.json: |
    {
      "type": "http",
      "name": "Grafana",
      "url": "https://grafana.lab.mtgibbs.dev/api/health",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  prometheus.json: |
    {
      "type": "http",
      "name": "Prometheus",
      "url": "http://kube-prometheus-kube-prome-prometheus.monitoring.svc:9090/-/healthy",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  unbound-dns.json: |
    {
      "type": "port",
      "name": "Unbound DNS",
      "hostname": "unbound.pihole.svc.cluster.local",
      "port": 5335,
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  k3s-api.json: |
    {
      "type": "port",
      "name": "K3s API",
      "hostname": "192.168.1.55",
      "port": 6443,
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  uptime-kuma.json: |
    {
      "type": "http",
      "name": "Uptime Kuma",
      "url": "https://status.lab.mtgibbs.dev/",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  homepage.json: |
    {
      "type": "http",
      "name": "Homepage",
      "url": "https://home.lab.mtgibbs.dev/",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  unifi.json: |
    {
      "type": "http",
      "name": "Unifi Controller",
      "url": "https://unifi.lab.mtgibbs.dev/",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  synology.json: |
    {
      "type": "http",
      "name": "Synology NAS",
      "url": "https://nas.lab.mtgibbs.dev/",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  jellyfin.json: |
    {
      "type": "http",
      "name": "Jellyfin",
      "url": "https://jellyfin.lab.mtgibbs.dev/health",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  immich.json: |
    {
      "type": "http",
      "name": "Immich",
      "url": "https://immich.lab.mtgibbs.dev/api/server/ping",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  personal-site-cluster.json: |
    {
      "type": "http",
      "name": "Personal Site (Cluster)",
      "url": "https://site.lab.mtgibbs.dev/",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  personal-site-heroku.json: |
    {
      "type": "http",
      "name": "Personal Site (Heroku)",
      "url": "https://mtgibbs.xyz/",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  tailscale-exit-node.json: |
    {
      "type": "dns",
      "name": "Tailscale Exit Node",
      "hostname": "ts-pi-cluster-exit-j2trp-0.ts-pi-cluster-exit-j2trp.tailscale.svc.cluster.local",
      "dns_resolve_server": "10.43.0.10",
      "dns_resolve_type": "A",
      "interval": 60,
      "retryInterval": 30,
      "maxretries": 3
    }
  # Status page for Homepage widget - uses __page_ prefix
  __page_home.json: |
    {
      "type": "status-page",
      "title": "Home Lab Status",
      "slug": "home",
      "description": "Pi K3s Cluster Services",
      "showPoweredBy": false,
      "publicGroupList": [
        {
          "name": "DNS",
          "weight": 1,
          "monitorList": ["pihole-dns", "pihole-admin", "unbound-dns"]
        },
        {
          "name": "Infrastructure",
          "weight": 2,
          "monitorList": ["k3s-api", "homepage", "uptime-kuma"]
        },
        {
          "name": "Monitoring",
          "weight": 3,
          "monitorList": ["grafana", "prometheus"]
        },
        {
          "name": "Network",
          "weight": 4,
          "monitorList": ["unifi", "tailscale-exit-node"]
        },
        {
          "name": "Media",
          "weight": 5,
          "monitorList": ["jellyfin", "immich", "synology"]
        },
        {
          "name": "Web",
          "weight": 6,
          "monitorList": ["personal-site-cluster", "personal-site-heroku"]
        }
      ]
    }
